<!-- src/app/components/calendar/calendar-view/calendar-view.component.html -->
<main class="calendar-shell" [appTimeMachineListenerDirective]="applyVirtualNowToCalendar.bind(this)">
  <!-- LEFT: To-Dos -->
  <aside class="todos-pane">
    <div class="todos-header">TO DOs</div>

    <div class="todo-list" *ngIf="upcomingActivities.length; else emptyTodos">
      <article class="todo-card" *ngFor="let a of upcomingActivities; trackBy: trackActivity">
        <div class="todo-body">
          <div class="todo-title">{{ a.title || 'Untitled' }}</div>
          <div class="todo-date"><em>Due date: {{ formatDue(a.due_date) }}</em></div>
        </div>
      </article>
    </div>

    <ng-template #emptyTodos>
      <div class="todo-empty">No upcoming activities</div>
    </ng-template>
  </aside>

  <!-- RIGHT: Calendar -->
  <section class="calendar-pane">
    <full-calendar #fc *ngIf="calendarVisible" [options]="calendarOptions"></full-calendar>
  </section>

  <!-- CREATE MODAL -->
  <div class="calendar-overlay" *ngIf="showCreate">
    <div class="calendar-create-wrapper">
      <button class="close-button" (click)="closeCreate()">×</button>
      <app-calendar-create [selectedDate]="selectedDate" (chiudi)="closeCreate()" (activityCreated)="onActivityCreated()"></app-calendar-create>
    </div>
  </div>

  <!-- INFO MODAL -->
  <div class="calendar-overlay" *ngIf="showInfo">
    <div class="calendar-create-wrapper">
      <button class="close-button" (click)="closeInfo()">×</button>
      <app-calendar-info [activity]="selectedActivity" [calendarEvent]="selectedEvent" (close)="closeInfo()" (delete)="deleteActivity($event)" (modify)="modifyActivity($event)"></app-calendar-info>
    </div>
  </div>
</main>